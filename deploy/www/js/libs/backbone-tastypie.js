(function(e,t,n){n.Tastypie={defaultLimit:20},t.extend(n.Model.prototype,{idAttribute:"resource_uri",url:function(){var e=r(this,"urlRoot")||r(this.collection,"urlRoot")||i();return this.isNew()?e:this.get("resource_uri")},_getId:function(){return this.has("id")?this.get("id"):t.chain(this.get("resource_uri").split("/")).compact().last().value()}}),t.extend(n.Collection.prototype,{initialize:function(e,r){t.bindAll(this,"fetchNext","fetchPrevious"),this.meta={},this.filters={limit:n.Tastypie.defaultLimit,offset:0},r&&r.filters&&t.extend(this.filters,r.filters)},url:function(e){var n=this.urlRoot;if(e){var r=t.map(e,function(e){return e._getId()});n+="set/"+r.join(";")+"/"}return n+this._getQueryString()},parse:function(e){return e&&e.meta&&(this.meta=e.meta),e&&e.objects},fetchNext:function(e){return e=e||{},e.add=!0,this.filters.limit=this.meta.limit,this.filters.offset=this.meta.offset+this.meta.limit,this.filters.offset>this.meta.total_count&&(this.filters.offset=this.meta.total_count),this.fetch.call(this,e)},fetchPrevious:function(e){return e=e||{},e.add=!0,e.at=0,this.filters.limit=this.meta.limit,this.filters.offset=this.meta.offset-this.meta.limit,this.filters.offset<0&&(this.filters.limit+=this.filters.offset,this.filters.offset=0),this.fetch.call(this,e)},_getQueryString:function(){return this.filters?"?"+e.param(this.filters):""}});var r=function(e,n){if(e&&e[n])return t.isFunction(e[n])?e[n]():e[n]},i=function(){throw new Error('A "url" property or function must be specified')}})(window.$,window._,window.Backbone)