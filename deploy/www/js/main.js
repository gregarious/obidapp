/**
 * @license RequireJS text 2.0.0 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

define("explore/models",[],function(){var e=function(e){return Scenable.constants.SITEURL+"/api/v1/"+e},t={},n=function(e){_.isObject(e)&&(_.isNumber(e.latitude)&&_.isNumber(e.longitude)?e.geocoding={latitude:e.latitude,longitude:e.longitude}:e.geocoding=null,delete e.latitude,delete e.longitude)};t.Place=Backbone.Model.extend({urlRoot:e("place"),parse:function(e){var t=Backbone.Model.prototype.parse.call(this,e);return n(t.location),t},headerText:function(){return this.get("name")}}),t.Event=Backbone.Model.extend({urlRoot:e("event"),parse:function(e){var t=Backbone.Model.prototype.parse.call(this,e);return n(t.place&&t.place.location),t},headerText:function(){return this.get("name")}}),t.Special=Backbone.Model.extend({urlRoot:e("special"),parse:function(e){var t=Backbone.Model.prototype.parse.call(this,e);return n(t.place&&t.place.location),t.hasExpired=t.dexpires&&moment(t.dexpires)<moment(),t},headerText:function(){return this.get("title")}});var r=Backbone.Collection.extend({meta:null,query:null,categoryId:null,initialize:function(e){e&&(this.query=e.query||null,this.categoryId=e.categoryId||null,this.limit=e.limit||null,this.offset=e.offset||null,this.locationTimeout=e.locationTimeout||5e3)},fetch:function(e){e.data=e.data||{},this.categoryId!==null&&(e.data.catpk=this.categoryId),this.query!==null&&(e.data.q=this.query),this.offset!==null&&(e.data.offset=this.offset),this.limit!==null&&(e.data.limit=this.limit);var t=this;navigator.geolocation.getCurrentPosition(function(n){e.data.lat=n.coords.latitude,e.data.lng=n.coords.longitude,Backbone.Collection.prototype.fetch.call(t,e)},function(n){t.trigger("geolocationError"),Backbone.Collection.prototype.fetch.call(t,e)},{timeout:this.locationTimeout,maximumAge:15e3,enableHighAccuracy:!0})},parse:function(e){return this.meta=e.meta,e.objects},getNextPageOptions:function(){return this.meta&&this.meta.next===null?null:{offset:this.meta.offset+this.meta.limit,limit:this.meta.limit,query:this.query,categoryId:this.categoryId}},getPrevPageOptions:function(){return this.meta&&this.meta.previous===null?null:{offset:this.meta.offset-this.meta.limit,limit:this.meta.limit,query:this.query,categoryId:this.categoryId}}});return t.Places=r.extend({model:t.Place,url:e("place"),fetch:function(e){return e.data=e.data||{},e.data.listed=!0,r.prototype.fetch.call(this,e)}}),t.Events=r.extend({model:t.Event,url:e("event"),fetch:function(e){return e.data=e.data||{},e.data.listed=!0,e.data.dtend__gt=moment().format(),r.prototype.fetch.call(this,e)}}),t.Specials=r.extend({model:t.Special,url:e("special"),fetch:function(e){return e.data=e.data||{},e.data.listed=!0,e.data.dexpires__gte=moment().format("YYYY-MM-DD"),r.prototype.fetch.call(this,e)}}),t.NewsArticles=r.extend({url:e("news"),fetch:function(e){return e.data=e.data||{},this.offset!==null&&(e.data.offset=this.offset),this.limit!==null&&(e.data.limit=this.limit),Backbone.Collection.prototype.fetch.call(this,e)}}),t.PlaceCategories=Backbone.Collection.extend({url:e("place_category"),parse:function(e){return e.objects}}),t.EventCategories=Backbone.Collection.extend({url:e("event_category"),parse:function(e){return e.objects}}),t}),define("text",["module"],function(e){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],n=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,r=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,i=typeof location!="undefined"&&location.href,s=i&&location.protocol&&location.protocol.replace(/\:/,""),o=i&&location.hostname,u=i&&(location.port||undefined),a=[],f=e.config(),l,c;return l={version:"2.0.0",strip:function(e){if(e){e=e.replace(n,"");var t=e.match(r);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r")},createXhr:function(){var e,n,r;if(typeof XMLHttpRequest!="undefined")return new XMLHttpRequest;if(typeof ActiveXObject!="undefined")for(n=0;n<3;n++){r=t[n];try{e=new ActiveXObject(r)}catch(i){}if(e){t=[r];break}}return e},parseName:function(e){var t=!1,n=e.indexOf("."),r=e.substring(0,n),i=e.substring(n+1,e.length);return n=i.indexOf("!"),n!==-1&&(t=i.substring(n+1,i.length),t=t==="strip",i=i.substring(0,n)),{moduleName:r,ext:i,strip:t}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,t,n,r){var i=l.xdRegExp.exec(e),s,o,u;return i?(s=i[2],o=i[3],o=o.split(":"),u=o[1],o=o[0],(!s||s===t)&&(!o||o===n)&&(!u&&!o||u===r)):!0},finishLoad:function(e,t,n,r){n=t?l.strip(n):n,f.isBuild&&(a[e]=n),r(n)},load:function(e,t,n,r){if(r.isBuild&&!r.inlineText){n();return}f.isBuild=r.isBuild;var a=l.parseName(e),c=a.moduleName+"."+a.ext,h=t.toUrl(c),p=f.useXhr||l.useXhr;!i||p(h,s,o,u)?l.get(h,function(t){l.finishLoad(e,a.strip,t,n)},function(e){n.error&&n.error(e)}):t([c],function(e){l.finishLoad(a.moduleName+"."+a.ext,a.strip,e,n)})},write:function(e,t,n,r){if(a.hasOwnProperty(t)){var i=l.jsEscape(a[t]);n.asModule(e+"!"+t,"define(function () { return '"+i+"';});\n")}},writeFile:function(e,t,n,r,i){var s=l.parseName(t),o=s.moduleName+"."+s.ext,u=n.toUrl(s.moduleName+"."+s.ext)+".js";l.load(o,n,function(t){var n=function(e){return r(u,e)};n.asModule=function(e,t){return r.asModule(e,u,t)},l.write(e,o,n,i)},i)}},typeof process!="undefined"&&process.versions&&!!process.versions.node?(c=require.nodeRequire("fs"),l.get=function(e,t){var n=c.readFileSync(e,"utf8");n.indexOf("ï»¿")===0&&(n=n.substring(1)),t(n)}):l.createXhr()?l.get=function(e,t,n){var r=l.createXhr();r.open("GET",e,!0),f.onXhr&&f.onXhr(r,e),r.onreadystatechange=function(i){var s,o;r.readyState===4&&(s=r.status,s>399&&s<600?(o=new Error(e+" HTTP status: "+s),o.xhr=r,n(o)):t(r.responseText))},r.send(null)}:typeof Packages!="undefined"&&(l.get=function(e,t){var n="utf-8",r=new java.io.File(e),i=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(r),n)),o,u,a="";try{o=new java.lang.StringBuffer,u=s.readLine(),u&&u.length()&&u.charAt(0)===65279&&(u=u.substring(1)),o.append(u);while((u=s.readLine())!==null)o.append(i),o.append(u);a=String(o.toString())}finally{s.close()}t(a)}),l}),define("text!templates/explore-menu.html",[],function(){return'<div id="top-bar">\n  <div id="top-logo">\n    <img src="img/logos/oakland-scene.png" />\n  </div>\n  <!-- When we have logins, display username here. Placeholder for now -->\n  <div id="current-user">&nbsp;</div>\n  <nav id="view-options">\n    <!-- Disabled for current iteration\n\n    <img class="icon-display icon-display-list" src="img/icons/list.png" />\n    <img class="icon-display icon-display-map" src="img/icons/map.png" /> -->\n    <!-- <img class="icon-search" src="img/icons/search.png" /> -->\n  </nav> <!-- .view-options -->\n</div> <!-- #top-bar -->\n\n<!-- Site nav not shown on single pages -->\n<nav class="explore-nav">\n  <ul>\n    <a href="#app/redirect?url=#app/now"><li id="nav-now" data-type="now"><div>Home</div></li></a>\n    <a href="#app/redirect?url=#app/places"><li id="nav-places" data-type="places"><div>Places</div></li></a>\n    <a href="#app/redirect?url=#app/events"><li id="nav-events" data-type="events"><div>Events</div></li></a>\n    <a href="#app/redirect?url=#app/specials"><li id="nav-specials" data-type="specials"><div>Specials</div></li></a>\n    <a href="#app/redirect?url=#app/news"><li id="nav-news" data-type="news"><div>News</div></li></a>\n  </ul>\n</nav> <!-- #site-nav -->'}),define("text!templates/explore-filter.html",[],function(){return'<div class="sorting">\n	<h1>Showing </h1>\n	<div class="select-container">\n		<select>\n			<option value="0">All Results</option>\n			{{#categories}}\n			<option value="{{id}}">{{label}}</option>\n			{{/categories}}\n		</select>\n	</div>\n</div>'}),define("text!templates/explore-loading.html",[],function(){return'<div class="loading">\n	<div class="loader-container">\n		<img src="img/loader.gif" />\n	</div>\n</div>'}),define("text!templates/explore-error.html",[],function(){return'<div class="error">\n	<p>{{message}}</p>\n</div>'}),define("text!templates/list-paging.html",[],function(){return'{{#if previous}}\n<div class="page-previous button-back"></div>\n{{/if}}\n{{#if next}}\n<div class="page-next"></div>\n{{/if}}	'}),define("text!templates/listitem-places.html",[],function(){return'<li>\n  <a class="tappable" href="#app/places/{{id}}">\n    \n    <div class="item-thumb">\n      {{#if image}}\n        <img src="{{domainUri image}}" />\n      {{else}}\n        <img src="img/defaults/default-place.png" />\n      {{/if}}\n    </div>\n\n    <section class="item-content">\n      <h1 class="item-title">{{name}}</h1>\n      <ul class="item-details">\n        <li>{{location.address}}</li>\n        <li>\n        {{#if categories}}\n        <li>\n            <ul class="category">\n                {{#each categories}}\n                <li>{{label}}</li>\n                {{/each}}\n            </ul>\n        </li>\n        {{/if}}\n        </li>\n      </ul> <!-- .item-details -->\n    </section> <!-- .item-content -->\n\n  </a>\n</li> <!-- feed list item -->\n'}),define("text!templates/listitem-events.html",[],function(){return'<li>\n  <a class="tappable" href="#app/events/{{id}}">\n    <div class="item-thumb">\n      {{#if image}}\n        <img src="{{domainUri image}}" />\n      {{else}}\n        <img src="img/defaults/default-event.png" />\n      {{/if}}\n    </div>\n\n    <section class="item-content">\n      <h1 class="item-title">{{name}}</h1>\n      <ul class="item-details">\n        <li>{{formatDateRange dtstart dtend}}</li>\n        {{#place}}\n          <li>at {{name}}</li>\n        {{/place}}\n\n        <li>\n        {{#if categories}}\n        <li>\n            <ul class="category">\n                {{#each categories}}\n                <li>{{label}}</li>\n                {{/each}}\n            </ul>\n        </li>\n        {{/if}}\n        </li>\n      </ul> <!-- .item-details -->\n    </section> <!-- .item-content -->\n\n  </a>\n</li> <!-- feed item -->'}),define("text!templates/listitem-specials.html",[],function(){return'<li>\n  <a class="tappable" href="#app/specials/{{id}}">\n    <div class="item-thumb">\n      {{#if place.image}}\n        <img src="{{domainUri place.image}}" />\n      {{else}}\n        <img src="img/defaults/default-special.png" />\n      {{/if}}\n    </div>\n    <section class="item-content">\n      <h1 class="item-title">{{title}}</h1>\n      <ul class="item-details">\n        <li>at {{place.name}}</li>\n        {{#if dexpires}}\n          <li>{{formatExpires dexpires}}</li>\n        {{/if}}\n        <li>\n          {{#if place.categories}}\n          <li>\n              <ul class="category">\n                  {{#each place.categories}}\n                  <li>{{label}}</li>\n                  {{/each}}\n              </ul>\n          </li>\n          {{/if}}\n      </ul> <!-- .item-details -->\n    </section> <!-- .item-content -->\n  </a>\n</li>'}),define("text!templates/listitem-news.html",[],function(){return'<li class="article">\n	<a class="tappable" href="{{fulltext_url}}" target="_blank">\n		<h1 class="item-title">{{title}}</h1>\n		<p class="source">{{source_name}}</p>\n		<!-- </section> -->\n		<p class="snippet">\n		<span class="date">{{formatArticleDate publication_date}}</span> - {{blurb}}\n		</p>\n		<p class="read-more source">Click to read more...</p>\n	</a>\n</li>'}),define("text!templates/listitem-noresults.html",[],function(){return'<li class="no-results">\n	<h1 class="item-title">No results found! Try another search.</h1>\n</li>\n'}),define("text!templates/mapfeed.html",[],function(){return'<div id="map_canvas">\n  I am a map!\n</div>\n\n<div class="custom-infowindow">\n  <div class="prev">\n    <img src="img/assets/arrow-left.png" />\n  </div>\n  \n  <div class="infowindow-info">\n    \n    <div class="item-thumb">\n      <img src="https://fbcdn-profile-a.akamaihd.net/hprofile-ak-ash2/161484_14205248_278738875_n.jpg" />\n    </div>\n\n    <div class="item-content">\n      <h1>Name</h1>\n      <!-- If its an event \n      <p>Date</p> -->\n      <ul class="category">\n        <li>Category1</li>\n        <li>Category2</li>\n      </ul>\n\n    </div> <!-- .item-content -->\n\n  </div> <!-- .infowindow-info -->\n\n  <div class="next">\n    <img src="img/assets/arrow-right.png">\n  </div>\n\n</div> <!-- .custom-infowindow -->\n\n<div class="load-more">\n  Load more...\n</div>\n\n<div class="sorting">\n    <select>\n        <option>Category</option>\n        <option>Retail</option>\n        <option>Food</option>\n        <option>Services</option>\n    </select>\n</div>\n'}),define("text!templates/home.html",[],function(){return'\n<article class="about">\n    <h1 class="item-title">Welcome to the Oakland Scene!</h1>\n    <p>This app is designed to connect you to all the great things to see and do in Oakland. It is constantly being updated with new happenings, so make sure to keep checking back!</p><br />\n    <p>Have any ideas or comments? Email us using the link below and be entered to win an Oakland Scene t-shirt!</p>\n\n	<div class="shirt-actions">\n	    \n	    <nav class="action-list">\n		    <ul>\n		    	<a href="https://www.facebook.com/pages/Only-in-Oakland/351740933073" target="_blank"><li class="action-facebook"><div>Facebook</div></li></a>\n		    	<a href="https://twitter.com/only_in_oakland" target="_blank"><li class="action-twitter"><div>Twitter</div></li></a>\n		    	<a href="mailto:contact@scenable.com"><li class="action-email"><div>Email</div></li></a>\n		    </ul>\n		</nav>\n		<div class="shirt-container">\n	    	<img src="img/assets/shirt.png" />\n	    </div>\n	</div>\n	<p class="description">Brought to you by the <a href="http://oaklandbid.org/" target="_blank">Oakland Business Improvement District</a>, <a href="http://ppnd.org/" target="_blank">Pittsburgh Partnership for Neighborhood Development</a> and <a href="http://scenable.com" target="_blank">Scenable</a>.</p>\n</article>'}),define("explore/views",["text!templates/explore-menu.html","text!templates/explore-filter.html","text!templates/explore-loading.html","text!templates/explore-error.html","text!templates/list-paging.html","text!templates/listitem-places.html","text!templates/listitem-events.html","text!templates/listitem-specials.html","text!templates/listitem-news.html","text!templates/listitem-noresults.html","text!templates/mapfeed.html","text!templates/home.html"],function(e,t,n,r,i,s,o,u,a,f,l,c){var h={};h.LoadingView=Backbone.View.extend({template:Handlebars.compile(n),render:function(){return this.$el.html(this.template()),this}}),h.ErrorView=Backbone.View.extend({template:Handlebars.compile(r),initialize:function(e){return this.message=e.message,this},render:function(){return this.$el.html(this.template({message:this.message})),this}}),h.MenuView=Backbone.View.extend({template:Handlebars.compile(e),activeSection:null,activeDisplayMode:null,events:{"click .icon-display":"displayModeClicked"},initialize:function(e){_.bindAll(this,"render","searchClicked","displayModeClicked")},setActiveNav:function(e,t){t=_.isUndefined(t)?!0:t,this.activeSection=e,t===!0&&this.render()},setActiveDisplayMode:function(e,t){t=_.isUndefined(t)?!0:t,this.activeDisplayMode=e,t===!0&&this.render()},render:function(){this.$el.html(this.template());var e=this.$(".icon-display-list"),t=this.$(".icon-display-map");this.activeDisplayMode==="list"?(e.hide(),t.show()):this.activeDisplayMode==="map"&&(t.hide(),e.show());var n=this.activeSection;return this.$("nav li").each(function(e,t){t=$(t),t.toggleClass("active",t.data("type")===n)}),this},displayModeClicked:function(){this.trigger("click:displayMode")},searchClicked:function(){this.trigger("click:searchOn")}}),h.NowView=Backbone.View.extend({template:Handlebars.compile(c),render:function(){return this.$el.html(this.template()),this}});var p=Backbone.View.extend({events:{"click .page-previous":"pagePrevious","click .page-next":"pageNext"},initialize:function(e){_.bindAll(this,"pagePrevious","pageNext")},pagePrevious:function(){this.trigger("page:prev")},pageNext:function(){this.trigger("page:next")}}),d=function(e){e.currentTarget.beingTapped=!0},v=function(e){e.currentTarget.beingTapped=!1},m=function(e){e.currentTarget.beingTapped===!0&&setTimeout(function(){$(e.currentTarget).trigger("tap")},300),e.currentTarget.beingTapped=!1};$.fn.tappable=function(){return this.each(function(){var e=$(this);e.on("touchstart",d),e.on("touchmove",v),e.on("touchend",m)}),this};var g=p.extend({itemTemplate:null,noResultsTemplate:Handlebars.compile(f),pagingTemplate:Handlebars.compile(i),events:function(){var e=p.prototype.events;return Modernizr.touch?_.extend(e,{"tap a.tappable":function(e){window.location=e.target.href},"click a.tappable":function(e){e.preventDefault()}}):e},render:function(){this.$el.empty();var e={previous:this.collection.meta&&this.collection.meta.previous,next:this.collection.meta&&this.collection.meta.next},t='<ul class="feed">';this.collection.length<1?t+=this.noResultsTemplate():this.collection.each(function(e){t+=this.itemTemplate(e.attributes)},this),t+="</ul>",this.$el.append(t),Modernizr.touch&&this.$("a.tappable").tappable();var n='<div class="paging">'+this.pagingTemplate(e)+"</div>";return this.$el.append(n),this}});return h.PlacesList=g.extend({itemTemplate:Handlebars.compile(s)}),h.EventsList=g.extend({itemTemplate:Handlebars.compile(o)}),h.SpecialsList=g.extend({itemTemplate:Handlebars.compile(u)}),h.NewsArticleList=g.extend({itemTemplate:Handlebars.compile(a)}),h.CategoryFilterView=Backbone.View.extend({template:Handlebars.compile(t),initialize:function(e){_.bindAll(this,"render","categorySelected")},render:function(){var e=this.collection.map(function(e){return e.attributes}),t=this.template({categories:e});return this.$el.html(t),this},categorySelected:function(e){var t=$(e.target).find("option:selected"),n=t.val();this.trigger("selected",n)}}),h}),define("explore/controller",["explore/models","explore/views"],function(e,t){var n=function(e,n,r){var i,s,o=null,u=null,a=null,f=function(){var e=null,t={map:null,list:null},n={};return{setFlag:function(e,t){n[e]=t},store:function(e,n){t[e]=n},retrieve:function(e){return t[e]},setActive:function(t){e=t},getActive:function(){return _.isString(e)?t[e]:e},displayActive:function(e){if(e){var t=this.getActive();t&&e.html(t.render().el)}}}}(),c=function(){f.setActive(new t.LoadingView),f.displayActive(i)},h={activate:function(e,t){i=e,this.setActiveDisplayMode(t)},deactivate:function(){i=null},setActiveDisplayMode:function(e){a=e,f.setActive(a),f.displayActive(i)},showDefaultFeed:function(){s=new e,this.updateViews()},showCategoryFiltered:function(t){s=new e({categoryId:t}),this.updateViews()},showSearchFiltered:function(t){s=new e({query:t}),this.updateViews()},showNextPage:function(){var t=s&&s.getNextPageOptions();t!==null&&(s=new e(t),this.updateViews())},showPrevPage:function(){var t=s&&s.getPrevPageOptions();t!==null&&(s=new e(t),this.updateViews())},mapNextItem:function(){},mapPrevItem:function(){},itemClicked:function(e){},updateViews:function(){c();var e=f.retrieve("list");e&&e.off();var o=n?new n({collection:s}):null;o.on("page:prev",this.showPrevPage,this),o.on("page:next",this.showNextPage,this),f.store("list",o);var u=f.retrieve("map");u&&u.off();var h=r?new r({collection:s}):null;f.store("map",h),f.setFlag("geolocationError",!1),s.off("geolocationError"),s.on("geolocationError",function(){f.setFlag("geolocationError",!0)});if(navigator.network){var p=navigator.network.connection.type;(p===Connection.NONE||p===Connection.UNKNOWN)&&navigator.notification.alert("No internet connection found.",null,"Connection Problem")}s.fetch({error:function(e,n){var r="Problem contacting server. Try again.";l=null,f.setActive(new t.ErrorView({message:r}))},complete:function(){f.displayActive(i)}}),f.setActive(a)}};return _.extend(h,Backbone.Events),h},r=function(e,t){var n=null,r=null,i=null,s={activate:function(s){i=s,n=new e,r=new t({collection:n})},deactivate:function(){i=null,n.off()},showDefaultFeed:function(){i&&i.html(r.render().el)}};return s},i={places:n(e.Places,t.PlacesList,null),events:n(e.Events,t.EventsList,null),specials:n(e.Specials,t.SpecialsList,null),news:n(e.NewsArticles,t.NewsArticleList,null),now:r(Backbone.Collection,t.NowView)},s={places:new t.CategoryFilterView({collection:new e.PlaceCategories}),events:new t.CategoryFilterView({collection:new e.EventCategories}),specials:new t.CategoryFilterView({collection:new e.PlaceCategories}),news:null,now:null},o=function(e){var t=new(Backbone.View.extend({findRegion:function(e){var t='[data-region="'+e+'"]';return this.$el.find(t)}}))({el:e});return t.$el.html('<div data-region="menu" id="header-view"></div><div id="content-view">	<div data-region="feed"></div>	<div class="push"></div></div><div data-region="filter" class="sorting"></div>'),t},u=new t.MenuView,a=null,f=null,l=null,c="list",h=function(e){if(e!==l){l=e,a&&a.deactivate(),a=i[e];if(!a){console.error('Warning: Unknown type arg "'+e+'" for ExploreController to act on.');return}a.activate();var t=k.findRegion("feed");a.activate(t,c),a.showDefaultFeed(),u.setActiveNav(l),p(s[e])}},p=function(e){f&&(f.off(),f.collection.off());var t=k.findRegion("filter");if(!e)return t.empty(),!1;e.collection.on("reset",function(){t.html(e.render().el),t.find("select").on("change",function(t){e.categorySelected(t)})}),e.collection.reset(),e.collection.fetch(),e.on("selected",function(e){m(e)}),f=e},d=function(e){c=e,u.setActiveDisplayMode(e),a&&a.setActiveDisplayMode(e)},v=function(e){a&&a.showSearchFiltered(e)},m=function(e){a&&(e<1?a.showDefaultFeed():a.showCategoryFiltered(e))},g=function(){a&&a.showNextPage()},y=function(){a&&a.showPrevPage()},b=function(e){},w=function(){},E=function(){},S=function(e,t,n,r){},x=function(){},T=function(){},N=function(){c==="map"?this.setState({displayMode:"list"}):c==="list"?this.setState({displayMode:"map"}):console.warn("Invalid activeDisplayMode: "+c)},C=function(){},k=null,L,A={activate:function(){L=$("#panel-explore"),k||(k=o(L)),L.show(),k.findRegion("menu").html(u.render().el),u.on("click:displayMode",N,this),u.on("click:searchOn",C,this)},deactivate:function(){u.off("click:displayMode"),u.off("click:displayMode"),L.hide()},setState:function(e,t){t=_.isUndefined(t)?!0:t;var n=!1;_.isUndefined(e.resourceType)||h(e.resourceType),_.isUndefined(e.displayMode)||d(e.displayMode),t&&u.render()},refreshStaticRegions:function(){k.findRegion("menu").html(u.render().el)}};return _.extend(A,Backbone.Events),A}),define("text!templates/single-place.html",[],function(){return'<script>\n\n$(document).ready(function(){\n   $(\'.place-info\').css(\'background\',\'green\');\n   console.log(\'working\');\n});\n</script>\n\n<div class="single-wrap">\n    <header class="single-header">\n\n        <div class="item-thumb">\n            {{#if image}}\n                <img src="{{domainUri image}}" />\n            {{else}}\n                <img src="img/defaults/default-event.png" />\n            {{/if}}\n        </div>\n\n        <article class="item-content">\n            <h1 class="item-title">{{name}}</h1>\n            <ul class="item-details">\n                <li>{{location.address}}</li>\n                {{#if categories}}\n                <li>\n                    <ul class="category">\n                        {{#each categories}}\n                        <li>{{label}}</li>\n                        {{/each}}\n                    </ul>\n                </li>\n                {{/if}}\n            </ul>\n\n        </article> <!-- .item-content -->\n\n    </header> <!-- .single-header -->\n\n   <!--  <nav class="single-place-nav">\n        <ul>\n            <li class="active" id="place-nav-info">Info</li>\n            <li id="place-nav-events">Events</li>\n            <li id="place-nav-specials">Specials</li>\n        </ul>\n    </nav>\n -->\n    <section class="single-content">\n\n        <article class="place-info">\n\n\n            <div class="hours">\n                <div class="detail-title">Hours:</div>\n                <ul class="hours">\n                    <li>Mon-Fri: 3pm-10pm</li>\n                    <li>Sat: 5pm-7pm</li>\n                    <li>Sun: Closed</li>\n                </ul>\n            </div>\n\n            <nav class="action-list">\n                <ul>\n                    {{#if phone}}\n                    <a href="tel:{{phone}}"><li class="action-call"><div>Call</div></li></a>\n                    {{/if}}\n                    {{#if fb_id}}\n                    <a href="http://facebook.com/{{fb_id}}" target="_blank"><li class="action-facebook"><div>Facebook</div></li></a>\n                    {{/if}}\n                    {{#if twitter_username}}\n                    <a href="" target="_blank"><li class="action-twitter"><div>Twitter</div></li></a>\n                    {{/if}}\n                    {{#if url}}\n                    <a href="{{url}}" target="_blank"><li class="action-website"><div>Website</div></li></a>\n                    {{/if}}\n                </ul>\n            </nav>\n\n            {{#location.geocoding}}\n            <div class="map-canvas">\n                <img src="{{getStaticMap latitude longitude}}"/>\n            </div>\n            {{/location.geocoding}}\n\n            <p class="description">{{description}}</p>\n\n        </article> <!-- .place-info -->\n\n       <!--  <article class="place-events">\n            <ul class="feed">\n            </ul>\n        </article>\n\n        <article class="place-specials">\n            <ul class="feed">\n            </ul>\n        </article> -->\n    </section>\n\n</div>'}),define("text!templates/single-event.html",[],function(){return'<div class="single-wrap">\n    <header class="single-header">\n        <div class="item-thumb">\n            {{#if image}}\n                <img src="{{domainUri image}}" />\n            {{else}}\n                <img src="img/defaults/default-event.png" />\n            {{/if}}\n        </div>\n        <div class="item-content">\n            <h1 class="item-title">{{name}}</h1>\n            <ul class="item-details">\n                <li>Starts: <strong>{{formatLongDate dtstart}}</strong><br/>\n                Ends: <strong>{{formatLongDate dtend}}</strong></li>\n                {{#place}}\n                    <li>at <a href="#app/places/{{id}}">{{name}}</a></li> \n                {{/place}}\n                <li>\n                    {{#if categories}}\n                    <li>\n                        <ul class="category">\n                            {{#each categories}}\n                            <li>{{label}}</li>\n                            {{/each}}\n                        </ul>\n                    </li>\n                    {{/if}}\n                </li>\n            </ul>\n        </div>\n    </header> <!-- .single-header -->\n\n    <article class="single-content" id="event-single-content">\n        {{#place.location.geocoding}}\n        <div class="map-canvas">\n            <img src="{{getStaticMap latitude longitude}}"/>\n        </div>\n        {{/place.location.geocoding}}\n\n        <nav class="action-list">\n            <ul>\n                {{#if fb_id}}\n                <a href="http://facebook.com" target="_blank"><li class="action-facebook"><div>Facebook</div></li></a>\n                {{/if}}\n                {{#if twitter_username}}\n                <a href="" target="_blank"><li class="action-twitter"><div>Twitter</div></li></a>\n                {{/if}}\n                {{#if url}}\n                <a href="{{url}}" target="_blank"><li class="action-website"><div>Website</div></li></a>\n                {{/if}}\n            </ul>\n        </nav>\n\n        <p class="description">{{description}}\n        </p>\n\n    </article> <!-- .single-content -->\n</div>'}),define("text!templates/single-special.html",[],function(){return'<div class="single-wrap">\n    <header class="single-header" id="special-single-head">\n        <div class="item-thumb">\n            {{#if place.image}}\n                <img src="{{domainUri place.image}}" />\n            {{else}}\n                <img src="img/defaults/default-special.png" />\n            {{/if}}\n        </div>\n        <div class="item-content">\n            <h1 class="item-title">{{title}}</h1>\n            <ul class="item-details">\n                {{#place}}\n                    <li>at <a href="#app/places/{{id}}">{{name}}</a></li>\n                    <li>{{location.address}}</li>\n                    {{#if categories}}\n                    <li>\n                        <ul class="category">\n                            {{#each categories}}\n                            <li>{{label}}</li>\n                            {{/each}}\n                        </ul>\n                    </li>\n                    {{/if}}\n                {{/place}}\n            </ul> <!-- .item-details -->\n        </div>\n    </header>\n\n    <article class="single-content" id="special-single-content">\n        {{#place.location.geocoding}}\n            <div class="map-canvas">\n                <img src="{{getStaticMap latitude longitude}}"/>\n            </div>\n        {{/place.location.geocoding}}\n        \n        {{#if dexpires}}\n            {{#if hasExpired}}\n                <h1 class="item-title">Expired {{formatSimple dexpires}}</h1>\n            {{else}}\n                <h1 class="item-title">Expires {{formatSimple dexpires}}</h1>\n            {{/if}}\n        {{/if}}\n        <p>{{description}}</p>\n\n        {{#unless hasExpired}}\n        <div class="coupon-info">\n            <h1>To redeem this coupon:</h1>\n            <p class="description">Show this screen at {{place.name}} to redeem this coupon.</p>\n        </div>\n        {{/unless}}\n        \n        <div class="push"></div>\n    </article>\n</div> <!-- .single-wrap -->'}),define("detail/views",["text!templates/single-place.html","text!templates/single-event.html","text!templates/single-special.html"],function(e,t,n){var r=Backbone.View.extend({template:null,events:{"click .button-back":"backClicked"},initialize:function(e){_.bindAll(this,"render")},render:function(){var e='<div class="topbar"><nav id="top-bar-single"><a class="button-back" href="#">&nbsp;</a><h1>'+this.model.headerText()+"</h1></nav></div>";return this.$el.html(e),this.template&&this.$el.append(this.template(this.model.attributes)),this},backClicked:function(e){e.preventDefault(),this.trigger("back")}}),i={PlaceDetail:r.extend({template:Handlebars.compile(e)}),EventDetail:r.extend({template:Handlebars.compile(t)}),SpecialDetail:r.extend({template:Handlebars.compile(n)})};return i}),define("detail/controller",["explore/models","detail/views","text!templates/explore-loading.html","text!templates/explore-error.html"],function(e,t,n,r){var i={places:{Model:e.Place,View:t.PlaceDetail},events:{Model:e.Event,View:t.EventDetail},specials:{Model:e.Special,View:t.SpecialDetail}},s,o=Handlebars.compile(r);loadingTemplate=Handlebars.compile(n);var u={activate:function(){s=$("#panel-detail"),s.show()},deactivate:function(){s.hide()},setState:function(e){var t=i[e.resourceType];t||contentEl.html("invalid resource type");var n=new t.Model({id:e.objectId}),r=new t.View({model:n});r.on("back",function(){window.history.back()}),s.html(loadingTemplate()),n.fetch({success:function(e,t){e===n&&s.html(r.render().el)},error:function(e,t){e===n&&s.html(o({message:"Server error!"}))}})}};return _.extend(u,Backbone.Events),u}),Scenable={constants:{MODE:"DEBUG",SITEURL:"http://www.scenable.com"}},moment.fn.formatRange=function(e,t){var n=moment();n.year()<e.year()?e=e.format("MMM D, YYYY, H:mm"):e=e.format("MMM D, H:mm"),t.diff(e,"days")<1?t=t.format("H:mm"):t=t.format("MMM D")},moment.calendar.sameElse="M/DD/YYYY",moment.longDateFormat.LLL="MMMM D YYYY, LT",requirejs.config({paths:{templates:"../../templates"}}),requirejs(["explore/controller","detail/controller"],function(e,t){var n=function(e,t,n){var r=n||{};return r.dataType="jsonp",Backbone.sync(e,t,r)};Backbone.Model.prototype.sync=n,Backbone.Collection.prototype.sync=n,Handlebars.registerHelper("domainUri",function(e){return Scenable.constants.SITEURL+e}),Handlebars.registerHelper("formatArticleDate",function(e){var t=moment(e);return t<moment().subtract("months",2)?t.format("MMM D, YYYY"):t.format("MMM D");var n,r}),Handlebars.registerHelper("formatExpires",function(e){var t=moment(e),n=t.calendar().split(" at")[0];return t<moment()?"Expired "+n:"Expires "+n}),Handlebars.registerHelper("formatDateRange",function(e,t){var n=moment(e),r=moment(t),i=moment();return n<i&&i<r?"ends "+r.calendar(!1):r.diff(n,"days")<1?n.calendar(!1)+" - "+r.format("LT"):n.calendar(!1)+" - "+r.calendar(!1)}),Handlebars.registerHelper("formatLongDate",function(e){return moment(e).format("LLL")}),Handlebars.registerHelper("formatSimple",function(e){return moment(e).format("M/D/YY")}),Handlebars.registerHelper("getStaticMap",function(e,t){return"http://maps.googleapis.com/maps/api/staticmap?markers="+e+","+t+"&zoom=15&size=300x100&sensor=true&"+"key=AIzaSyBCJCI3JVemxWbwwWbPCQk8YX3LwqfVtfM"}),window.app=new(Backbone.Router.extend({states:{explore:e,detail:t},currentState:null,routes:{"":"index","app/redirect":"redirect","app/:resource/:id":"detailPage","app/:resource":"exploreFeed"},index:function(){this.navigate("app/now",{trigger:!0})},pageTransition:function(e){if(this.currentState===e)return;this.currentState&&this.currentState.deactivate(),this.currentState=e,e.activate()},exploreFeed:function(e){this.pageTransition(this.states.explore),this.states.explore.setState({resourceType:e})},detailPage:function(e,t){this.pageTransition(this.states.detail),this.states.detail.setState({resourceType:e,objectId:t})},redirect:function(e){window.location=e.url}})),$.ajaxSetup({timeout:8e3}),$(function(){$("#panel-explore").hide(),$("#panel-detail").hide(),document.addEventListener("deviceready",function(){window.app.states.explore.setState({displayMode:"list"},!1),Backbone.history.start()},!1)})}),define("main",function(){})